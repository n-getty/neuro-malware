import numpy as np
from sklearn.model_selection import train_test_split


data = np.load('data/malimg.npz')['arr']

X = data[:,0]
X = np.array([feature for feature in X])
X = np.reshape(X, (X.shape[0], X.shape[1], X.shape[2]))

y = data[:,1]
y = np.array([label for label in y]).reshape(-1, 1)

x_train, x_test, y_train, y_test = train_test_split(X, y, test_size=0.30, stratify=y)

num_train = len(y_train)
num_test = len(y_test)

training = {'x': x_train, 'y': y_train}
testing = {'x': x_test, 'y': y_test}

np.savez('data/training.npz', training)
np.savez('data/testing.npz', testing)